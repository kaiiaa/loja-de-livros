const dadosProdutos = {

    manga: [
        {
            nome : "O cara que estou a fim não é um cara - Volume 1",
            descricao : "Aya é uma garota do ensino médio que está muito interessada em um “moço” misterioso que trabalha em uma loja de CDs. Porém, esse rapaz misterioso na verdade era Mitsuki, sua colega de classe que tenta viver invisível como o ar. Um amor que se desenvolve com rapidez, a partir de um encontro impossível e caminha para...",
            img : "img/ocaraque.jpg",
            preco: "R$ 27,90"
        },
        {
            nome : "Delicous in dungeon - Volume 1",
            descricao : "Depois de serem atacados por um dragão, o grupo do aventureiro Laios acaba perdendo todo seu dinheiro e provisões. Assim, mesmo que o grupo tente adentrar novamente o calabouço, é certo que eles morrerão de fome... Diante dessa situação, Laios acaba tendo uma ideia: Comer os monstros pelo caminho, desde slimes até dragões!!",
            img : "img/delicous01.webp",
            preco: "R$ 42,90"
        },
        {
            nome : "Nana - Volume 2",
            descricao : "Enfim, Nana Komatsu vê um de seus sonhos começando a se tornar realidade… Seu namorado, Shoji, lhe envia uma mensagem dizendo que conseguiu passar no vestibular, e logo estará cursando a tão sonhada Faculdade de Artes. É hora, então, de arrumar as malas, comprar uma passagem só de ida e embarcar rumo a Tóquio! Com apenas um maço de cigarros e sua guitarra como bagagem, Nana Oosaki compra sua passagem, só de ida, para a capital do Japão. Lá, a garota descolada espera conseguir alcançar um de seus sonhos: o sucesso em sua carreira. Ambas se encontram no trem em direção à capital e conversam muito, mas ao chegarem a seu destino, cada uma toma seu caminho. No entanto, o destino trata de juntar as duas novamente… No apartamento 707 do 7º andar, Nana Oosaki e Nana Komatsu estão prestes a começar a busca por seus sonhos.",
            img : "img/nana2.webp",
            preco: "R$ 29,99"
        },
        {
            nome : "O cara que estou a fim não é um cara - Volume 2",
            descricao : "DDepois de descobrir que “o cara da qual estava a fim não era um cara”, Aya fica sem saber distinguir se o que elas têm é uma amizade ou se é alguma coisa totalmente distinta. Por outro lado, Mitsuki está em conflito com o distanciamento correto que deveria ter com Aya. “Para mim você é... Para você eu sou...? Que tipo de existência somos uma para a outra?” E, mesmo assim, a relação das duas, criada a partir da “música”, não consegue ir contra a atração e continua avançando com tudo... ",
            img : "img/ocaraque2.jpg",
            preco: "R$ 27,90"
        },
        {
            nome : "Look Back",
            descricao : "Esta é a história de Fujino e Kyomoto.Enquanto uma tem confiança absoluta em seu talento, a outra é uma reclusa que nunca sai de casa. Mas o amor e a dedicação que ambas possuem por desenhar mangá acaba unindo essas duas jovens de uma pequena cidade do interior.Um fantástico conto sobre a juventude feito a partir de um olhar único e especial.",
            img : "img/lookback.jpg",
            preco: "R$ 24,99"
        },
        {
            nome : "Love-bullet",
            descricao : "Desde o início da humanidade, aqueles que nunca experimentaram o amor e têm um fim prematuro recebem uma segunda chance de vida como Cupidos, concedida pela Deusa do Amor. Os Cupidos de hoje trocaram o arco e flecha por armas de fogo modernas, mas sua missão continua a mesma: encontrar pares ideais para seus alvos e fazê-los se apaixonar!",
            img : "img/lovebullet.jpg",
            preco: "R$ 30,90"
        },
        {
            nome : "Nana - Volume 1",
            descricao : "Nana Komatsu é uma garota do interior com simples objetivos de vida e que se apaixona facilmente à primeira vista. Nana Oosaki é a vocalista de uma banda punk e tem como um de seus objetivos fazer com que sua banda estoure nas paradas. Sonhos tão distintos, para duas garotas com o mesmo nome… Descubra o que o destino reserva para as “duas Nanas”.",
            img : "img/nana1.webp",
            preco: "R$ 30,99"
        }
    ],
    graphicnovels: [
        {
            nome : "Beyond the Woods",
            descricao : "Beyond the Woods é uma HQ experimental que não possui falas, contada apenas através de expressões e cores que representam as emoções de cada arco. Ela conta a história de Dikon e Amy, um lobo e uma raposa que se tornam amigos improváveis. Deixando para trás os bosques sombrios, Dikon segue a raposa para dentro de um novo e belo mundo. Mas quando seu passado retorna para roubar a luz de sua vida, o lobo deve tomar a decisão de colocar um fim em seus medos ou voltar a se esconder nas sombras. Será que eles conseguirão vencer a escuridão e caminhar juntos em direção a uma nova manhã?",
            link : "hhttps://www.amazon.com.br/Look-Back-01-Tatsuki-Fujimoto/dp/6525906318/?encoding=UTF8&pd_rd_w=c2MKt&content-id=amzn1.sym.224d7d82-280f-41b5-9062-56d96131c8c9%3Aamzn1.symc.abfa8731-fff2-4177-9d31-bf48857c2263&pf_rd_p=224d7d82-280f-41b5-9062-56d96131c8c9&pf_rd_r=Z64SV39DHZ09D5Y8KHKM&pd_rd_wg=4FTZx&pd_rd_r=ad8083e5-5e62-4b35-ad22-6dce69d2b805&ref=pd_hp_d_btf_ci_mcx_mr_ca_id_hp_d",
            img : "img/beyond.jpg",
            preco: "R$ 50,90"
        },
        {
            nome : "Revolução dos bichos - Graphic Novel",
            descricao : "Exaustos por realizar suas tarefas na fazenda, os animais se rebelam contra os humanos, na esperança de criar uma sociedade na qual possam ser iguais, livres e felizes. Entretanto, parte dos animais, se aproveitando da boa vontade dos demais, logo transformam o sonho em um grande pesadelo. Nesta edição em quadrinhos, vemos a maestria com que George Orwell faz uma crítica social atemporal, mostrando como alguns líderes se transformam em ditadores e como o povo é manipulado por quem detém o poder. Todos os animais são iguais, mas uns são mais iguais do que outros.",
            link : "https://www.amazon.com.br/revolu%C3%A7%C3%A3o-dos-bichos-HQ/dp/6550972353/ref=sr_1_16?__mk_pt_BR=%C3%85M%C3%85%C5%BD%C3%95%C3%91&crid=340SPCXU102IM&dib=eyJ2IjoiMSJ9.oj35rOpwchMYwC73Z-UR-k3gfR8kl4MLL7jNeXf1jRbUO6drBuhEHl730GJ_I91ciexs8Iaw_U6K7lsbAf-8fogPdStKXCMF4SDpwJPcXMbHoTW64CFtH4PLvqbwcpo23FWbz7qBoQ5xhem-yOasewAO1Q0k7AyBrVvn0ISuiWT0O4Lvxc5lfvF3_7neHaSwp2eOiNB8392jRF4CDJqTPfvhU_zCinzg4xXtew2eepQ.E8ryxeaSapHFjhYjP4XwsZIqwuvO1lEaEqhiG9S987I&dib_tag=se&keywords=graphic+novels&qid=1748688734&s=books&sprefix=graphic+novel%2Cstripbooks%2C159&sr=1-16",
            img : "img/revolucao.jpg",
            preco: "R$ 29,90"
        }
    ],
    outros: [
        {
            nome: "Chaveiro Dungeon Meshi - Laios e Senshi",
            descricao: "Chaveiro de Dungeon Meshi com Laios e Senshi",
            img: "img/chaveirolaiossenshi.jpg",
            preco: "R$ 34,90"
        },
        {
            nome: "Minichaveiros - Dungeon Meshi",
            descricao: "10 minichaveiros de personagens de Dungeon Meshi",
            img: "img/chaveirosdungeonmeshimini.jpg",
            preco: "R$ 35,90"
        },
        {
            nome: "Chaveiro - Falin na barriga do Dragão Vermelho",
            descricao: "Falin dentro da barriga do Dragão Vermelho",
            img: "img/chaveirofalindragao.jpg",
            preco: "R$ 30,90"
        },
        {
            nome: "Minichaveiros - Witch Hat Atelier",
            descricao: "Minichaveiros das personagens principais de Witch Hat Atelier",
            img: "img/chaveiroswha.jpg",
            preco: "R$ 45,90"
        },
        {
            nome: "Minichaveiros - Ivan e Sua",
            descricao: "Ivan e Sua de AlienStage",
            img: "img/alst1.jpg",
            preco: "R$ 45,90"
        }
        
    ],
    novels: [
        {
            nome : "Clear and muddy loss of love - 泾渭情殇",
            descricao : "Esta é a primeira aventura da incrível série Gatos guerreiros (Warriors), que teve mais de 6 milhões de exemplares vendidos na Europa e nos Estados Unidos.Um fosso natural chamado rio Luo dividia a grande terra em duas partes: Jing ao norte, e Wei ao sul. Um era o Príncipe das planícies de grama, que não conhecia preocupações nem tristezas. O outro era uma Princesa justa, que recebia o favor exclusivo do Imperador. Uma guerra transformou o Príncipe das planícies de grama em órfão. Aquela que havia permanecido em silêncio por dez anos originalmente planejava tornar-se uma oficial bajuladora, para manipular o reino inimigo e lançá-lo no caos — mas foi nomeada como Fuma no banquete de Chionglin. Espere e veja como essa dívida de rancor, fruto de um reino caído e um lar destruído, será resolvida.",
            img : "img/jwqs.webp",
            preco: "R$ 80,99"
        }

    ],
};

// Disponibiliza os dados globalmente
window.dadosProdutos = dadosProdutos;

    
    










let categoriaAtual = 'todos';
let dados = {};

function carregarDados(dadosExternos) {
    dados = dadosExternos;
    filtrarProdutos('todos');
}

function exibirResultados(itens) {
    const section = document.getElementById("resultados-pesquisa");
    section.innerHTML = '';
    

    if (!itens || itens.length === 0) {
        section.innerHTML = '<p class="sem-resultados">Nenhum produto encontrado.</p>';
        return;
    }

    // Cria 3 colunas
    const colunasContainer = document.createElement('div');
    colunasContainer.className = 'produtos-colunas';
    section.appendChild(colunasContainer);

    const colunas = [[], [], []]; // Array para as 3 colunas

    // Distribui os itens pelas colunas
    itens.forEach((produto, index) => {
        colunas[index % 3].push(produto);
    });

    // Cria as colunas no HTML
    colunas.forEach(colunaItens => {
        const coluna = document.createElement('div');
        coluna.className = 'produtos-coluna';
        
        colunaItens.forEach(produto => {
            coluna.innerHTML += `
                <div class="item-resultado">
                    <img src="${produto.img}" alt="${produto.nome}" loading="lazy">
                    <h2>${produto.nome}</h2>
                    <p class="descricao-meta">${produto.descricao}</p>
                    <span class="preco">${produto.preco}</span>
                    <button class="botao-comprar" onclick="adicionarAoCarrinho('${produto.nome}')">Comprar</button>
                </div>
            `;
        });
        
        colunasContainer.appendChild(coluna);
    });
    

}

function filtrarProdutos(categoria) {
    categoriaAtual = categoria;
    atualizarMenuAtivo();
    
    if (categoria === 'todos') {
        // Junta todos os produtos de todas as categorias
        const todosProdutos = [...dados.manga, ...dados.novels, ...dados.graphicnovels, ...dados.outros];
        exibirResultados(todosProdutos);
    } else {
        exibirResultados(dados[categoria]);
    }
}

function pesquisar() {
    const termo = document.getElementById("campo-pesquisa").value.toLowerCase().trim();
    
    let produtos;
    if (categoriaAtual === 'todos') {
        produtos = [...dados.manga, ...dados.novels, ...dados.graphicnovels, ...dados.outros];
    } else {
        produtos = dados[categoriaAtual];
    }

    if (!termo) {
        exibirResultados(produtos);
        return;
    }

    const resultados = produtos.filter(produto =>
        produto.nome.toLowerCase().includes(termo) ||
        produto.descricao.toLowerCase().includes(termo)
    );

    exibirResultados(resultados);
}

function atualizarMenuAtivo() {
    document.querySelectorAll('.menu-lista a').forEach(link => {
        const categoriaLink = link.getAttribute('onclick').match(/'([^']+)'/)[1];
        link.classList.toggle('menu-ativo', categoriaLink === categoriaAtual);
    });
}

function adicionarAoCarrinho(nomeProduto) {
    alert(`${nomeProduto} adicionado ao carrinho!`);
}

// Inicialização
document.addEventListener("DOMContentLoaded", () => {
    // Carrega os dados diretamente (sem depender de window.dadosProdutos)
    carregarDados(dadosProdutos); // Usa o objeto já definido no arquivo
    
    // Configura a pesquisa ao pressionar Enter
    document.getElementById("campo-pesquisa").addEventListener("keypress", (e) => {
        if (e.key === "Enter") pesquisar();
    });
});